!function(){"use strict";const main=document.querySelector("#main"),addButton=document.querySelector("#add"),exportToExcel=document.querySelector("#export");function toggleClass(e){e.stopPropagation(),e.preventDefault(),this.classList.toggle("selected")}let counter=0;function filler(e){const val=getValue("#text"),firstNum=val[0];val[2];return counter+=Number(firstNum),counter%firstNum==0?1:0}function getValue(element){return document.querySelector(element).value}function removeElement(){this.parentElement.remove()}function addText(e){if(e.stopPropagation(),e.preventDefault(),!this.innerText.length)return this.innerText=getValue("#text");this.innerText=""}function CreateOneWindow(element,data){return this.element=document.createElement(element),this.element.innerHTML=data,this.element}!function(){let counter=0}();const getAllDivs=function(e){const[a,...listOfAll]=e.parentElement.children;return listOfAll.length=listOfAll.length-3,listOfAll};function nextElement(){const elements=getAllDivs(this);if(elements.length<2)return;const lastText=elements[elements.length-1].innerText;for(let i=elements.length-1;i>0;i--)elements[i].innerText=elements[i-1].innerText;elements[0].innerText=lastText}function prevElement(){const elements=getAllDivs(this);if(elements.length<2)return;const firstText=elements[0].innerText;for(let i=0;i<elements.length-1;i++)elements[i].innerText=elements[i+1].innerText;elements[elements.length-1].innerText=firstText}function CreateRow(days,name){if(name.length>0){let table;main.children.length>0?table=document.getElementsByTagName("table")[0]:(table=document.createElement("table"),table.id="table",table.setAttribute("cellpadding","0"),table.setAttribute("cellspacing","0"),table.style.gridTemplateColumns=`repeat(${Number(days)+4}, minmax(20px, 1fr))`),this.days="number"==typeof Number(days)&&days>=28&&days<=31?Number(days):31,this.row=document.createDocumentFragment(),this.line=new CreateOneWindow("tr",""),this.row.appendChild(this.line);const nameElement=new CreateOneWindow("td",name);nameElement.addEventListener("dblclick",addText.bind(nameElement)),this.line.appendChild(nameElement);for(let i=1;i<=this.days;i++){let fill=i<10?`0${i}`:i;getValue("#text").indexOf("+")>0?fill=filler():getValue("#text").length>0&&(fill=getValue("#text"));const elem=new CreateOneWindow("td",fill);elem.align="center",elem.className="Name",elem.onclick=toggleClass.bind(elem),elem.ondblclick=addText.bind(elem),this.line.appendChild(elem)}const remove=new CreateOneWindow("td","remove"),left=new CreateOneWindow("td","<"),right=new CreateOneWindow("td",">");right.onclick=nextElement.bind(right),left.onclick=prevElement.bind(left),remove.onclick=removeElement.bind(remove),this.line.appendChild(remove),this.line.appendChild(left),this.line.appendChild(right),table.appendChild(this.row),main.appendChild(table)}}const tableToExcel=function(table,name){table.nodeType||(table=document.getElementById(table));const ctx={worksheet:name||"Worksheet",table:table.innerHTML};var c;window.location.href="data:application/vnd.ms-excel;base64,"+function(s){return window.btoa(unescape(encodeURIComponent(s)))}((c=ctx,'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>'.replace(/{(\w+)}/g,(function(m,p){return c[p]}))))};document.getElementById("add-text-to-selected").addEventListener("click",(function(){main.querySelectorAll(".selected").forEach((element=>element.innerText=getValue("#text")))})),exportToExcel.addEventListener("click",(()=>tableToExcel("table"))),addButton.addEventListener("click",(()=>{new CreateRow(getValue("#number"),getValue("#name"))})),new CreateRow(getValue("#number"),"Name")}();